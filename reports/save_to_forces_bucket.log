Traceback (most recent call last):
  File "/home/runner/micromamba-root/envs/clivar/lib/python3.10/site-packages/jupyter_cache/executors/utils.py", line 51, in single_nb_execution
    executenb(
  File "/home/runner/micromamba-root/envs/clivar/lib/python3.10/site-packages/nbclient/client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "/home/runner/micromamba-root/envs/clivar/lib/python3.10/site-packages/nbclient/util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "/home/runner/micromamba-root/envs/clivar/lib/python3.10/site-packages/nbclient/util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "/home/runner/micromamba-root/envs/clivar/lib/python3.10/asyncio/base_events.py", line 646, in run_until_complete
    return future.result()
  File "/home/runner/micromamba-root/envs/clivar/lib/python3.10/site-packages/nbclient/client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "/home/runner/micromamba-root/envs/clivar/lib/python3.10/site-packages/nbclient/client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "/home/runner/micromamba-root/envs/clivar/lib/python3.10/site-packages/nbclient/client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
for file in list_files:
    s3_path_file = os.path.join(s3_prefix, os.path.basename(file))
    print(file, s3_path_file)
    target.put(file, s3_path_file)
------------------

[0;31m---------------------------------------------------------------------------[0m
[0;31mNoCredentialsError[0m                        Traceback (most recent call last)
Cell [0;32mIn [8], line 4[0m
[1;32m      2[0m s3_path_file [38;5;241m=[39m os[38;5;241m.[39mpath[38;5;241m.[39mjoin(s3_prefix, os[38;5;241m.[39mpath[38;5;241m.[39mbasename(file))
[1;32m      3[0m [38;5;28mprint[39m(file, s3_path_file)
[0;32m----> 4[0m target[38;5;241m.[39mput(file, s3_path_file)

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/fsspec/asyn.py:111[0m, in [0;36msync_wrapper.<locals>.wrapper[0;34m(*args, **kwargs)[0m
[1;32m    108[0m [38;5;129m@functools[39m[38;5;241m.[39mwraps(func)
[1;32m    109[0m [38;5;28;01mdef[39;00m [38;5;21mwrapper[39m([38;5;241m*[39margs, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m    110[0m     [38;5;28mself[39m [38;5;241m=[39m obj [38;5;129;01mor[39;00m args[[38;5;241m0[39m]
[0;32m--> 111[0m     [38;5;28;01mreturn[39;00m [43msync[49m[43m([49m[38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43mloop[49m[43m,[49m[43m [49m[43mfunc[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[43margs[49m[43m,[49m[43m [49m[38;5;241;43m*[39;49m[38;5;241;43m*[39;49m[43mkwargs[49m[43m)[49m

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/fsspec/asyn.py:96[0m, in [0;36msync[0;34m(loop, func, timeout, *args, **kwargs)[0m
[1;32m     94[0m     [38;5;28;01mraise[39;00m FSTimeoutError [38;5;28;01mfrom[39;00m [38;5;21;01mreturn_result[39;00m
[1;32m     95[0m [38;5;28;01melif[39;00m [38;5;28misinstance[39m(return_result, [38;5;167;01mBaseException[39;00m):
[0;32m---> 96[0m     [38;5;28;01mraise[39;00m return_result
[1;32m     97[0m [38;5;28;01melse[39;00m:
[1;32m     98[0m     [38;5;28;01mreturn[39;00m return_result

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/fsspec/asyn.py:53[0m, in [0;36m_runner[0;34m(event, coro, result, timeout)[0m
[1;32m     51[0m     coro [38;5;241m=[39m asyncio[38;5;241m.[39mwait_for(coro, timeout[38;5;241m=[39mtimeout)
[1;32m     52[0m [38;5;28;01mtry[39;00m:
[0;32m---> 53[0m     result[[38;5;241m0[39m] [38;5;241m=[39m [38;5;28;01mawait[39;00m coro
[1;32m     54[0m [38;5;28;01mexcept[39;00m [38;5;167;01mException[39;00m [38;5;28;01mas[39;00m ex:
[1;32m     55[0m     result[[38;5;241m0[39m] [38;5;241m=[39m ex

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/fsspec/asyn.py:492[0m, in [0;36mAsyncFileSystem._put[0;34m(self, lpath, rpath, recursive, callback, batch_size, **kwargs)[0m
[1;32m    489[0m fs [38;5;241m=[39m LocalFileSystem()
[1;32m    490[0m lpaths [38;5;241m=[39m fs[38;5;241m.[39mexpand_path(lpath, recursive[38;5;241m=[39mrecursive)
[1;32m    491[0m rpaths [38;5;241m=[39m other_paths(
[0;32m--> 492[0m     lpaths, rpath, exists[38;5;241m=[39m[38;5;28misinstance[39m(rpath, [38;5;28mstr[39m) [38;5;129;01mand[39;00m [38;5;28;01mawait[39;00m [38;5;28mself[39m[38;5;241m.[39m_isdir(rpath)
[1;32m    493[0m )
[1;32m    495[0m is_dir [38;5;241m=[39m {l: os[38;5;241m.[39mpath[38;5;241m.[39misdir(l) [38;5;28;01mfor[39;00m l [38;5;129;01min[39;00m lpaths}
[1;32m    496[0m rdirs [38;5;241m=[39m [r [38;5;28;01mfor[39;00m l, r [38;5;129;01min[39;00m [38;5;28mzip[39m(lpaths, rpaths) [38;5;28;01mif[39;00m is_dir[l]]

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/s3fs/core.py:1249[0m, in [0;36mS3FileSystem._isdir[0;34m(self, path)[0m
[1;32m   1247[0m [38;5;66;03m# This only returns things within the path and NOT the path object itself[39;00m
[1;32m   1248[0m [38;5;28;01mtry[39;00m:
[0;32m-> 1249[0m     [38;5;28;01mreturn[39;00m [38;5;28mbool[39m([38;5;28;01mawait[39;00m [38;5;28mself[39m[38;5;241m.[39m_lsdir(path))
[1;32m   1250[0m [38;5;28;01mexcept[39;00m [38;5;167;01mFileNotFoundError[39;00m:
[1;32m   1251[0m     [38;5;28;01mreturn[39;00m [38;5;28;01mFalse[39;00m

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/s3fs/core.py:646[0m, in [0;36mS3FileSystem._lsdir[0;34m(self, path, refresh, max_items, delimiter, prefix)[0m
[1;32m    644[0m files [38;5;241m=[39m []
[1;32m    645[0m dircache [38;5;241m=[39m []
[0;32m--> 646[0m [38;5;28;01masync[39;00m [38;5;28;01mfor[39;00m i [38;5;129;01min[39;00m it:
[1;32m    647[0m     dircache[38;5;241m.[39mextend(i[38;5;241m.[39mget([38;5;124m"[39m[38;5;124mCommonPrefixes[39m[38;5;124m"[39m, []))
[1;32m    648[0m     [38;5;28;01mfor[39;00m c [38;5;129;01min[39;00m i[38;5;241m.[39mget([38;5;124m"[39m[38;5;124mContents[39m[38;5;124m"[39m, []):

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/aiobotocore/paginate.py:30[0m, in [0;36mAioPageIterator.__anext__[0;34m(self)[0m
[1;32m     27[0m [38;5;28mself[39m[38;5;241m.[39m_inject_starting_params(current_kwargs)
[1;32m     29[0m [38;5;28;01mwhile[39;00m [38;5;28;01mTrue[39;00m:
[0;32m---> 30[0m     response [38;5;241m=[39m [38;5;28;01mawait[39;00m [38;5;28mself[39m[38;5;241m.[39m_make_request(current_kwargs)
[1;32m     31[0m     parsed [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_extract_parsed_response(response)
[1;32m     32[0m     [38;5;28;01mif[39;00m first_request:
[1;32m     33[0m         [38;5;66;03m# The first request is handled differently.  We could[39;00m
[1;32m     34[0m         [38;5;66;03m# possibly have a resume/starting token that tells us where[39;00m
[1;32m     35[0m         [38;5;66;03m# to index into the retrieved page.[39;00m

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/aiobotocore/client.py:341[0m, in [0;36mAioBaseClient._make_api_call[0;34m(self, operation_name, api_params)[0m
[1;32m    339[0m [38;5;28;01melse[39;00m:
[1;32m    340[0m     apply_request_checksum(request_dict)
[0;32m--> 341[0m     http, parsed_response [38;5;241m=[39m [38;5;28;01mawait[39;00m [38;5;28mself[39m[38;5;241m.[39m_make_request(
[1;32m    342[0m         operation_model, request_dict, request_context
[1;32m    343[0m     )
[1;32m    345[0m [38;5;28;01mawait[39;00m [38;5;28mself[39m[38;5;241m.[39mmeta[38;5;241m.[39mevents[38;5;241m.[39memit(
[1;32m    346[0m     [38;5;124m'[39m[38;5;124mafter-call.[39m[38;5;132;01m{service_id}[39;00m[38;5;124m.[39m[38;5;132;01m{operation_name}[39;00m[38;5;124m'[39m[38;5;241m.[39mformat(
[1;32m    347[0m         service_id[38;5;241m=[39mservice_id, operation_name[38;5;241m=[39moperation_name
[0;32m   (...)[0m
[1;32m    352[0m     context[38;5;241m=[39mrequest_context,
[1;32m    353[0m )
[1;32m    355[0m [38;5;28;01mif[39;00m http[38;5;241m.[39mstatus_code [38;5;241m>[39m[38;5;241m=[39m [38;5;241m300[39m:

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/aiobotocore/client.py:366[0m, in [0;36mAioBaseClient._make_request[0;34m(self, operation_model, request_dict, request_context)[0m
[1;32m    362[0m [38;5;28;01masync[39;00m [38;5;28;01mdef[39;00m [38;5;21m_make_request[39m(
[1;32m    363[0m     [38;5;28mself[39m, operation_model, request_dict, request_context
[1;32m    364[0m ):
[1;32m    365[0m     [38;5;28;01mtry[39;00m:
[0;32m--> 366[0m         [38;5;28;01mreturn[39;00m [38;5;28;01mawait[39;00m [38;5;28mself[39m[38;5;241m.[39m_endpoint[38;5;241m.[39mmake_request(
[1;32m    367[0m             operation_model, request_dict
[1;32m    368[0m         )
[1;32m    369[0m     [38;5;28;01mexcept[39;00m [38;5;167;01mException[39;00m [38;5;28;01mas[39;00m e:
[1;32m    370[0m         [38;5;28;01mawait[39;00m [38;5;28mself[39m[38;5;241m.[39mmeta[38;5;241m.[39mevents[38;5;241m.[39memit(
[1;32m    371[0m             [38;5;124m'[39m[38;5;124mafter-call-error.[39m[38;5;132;01m{service_id}[39;00m[38;5;124m.[39m[38;5;132;01m{operation_name}[39;00m[38;5;124m'[39m[38;5;241m.[39mformat(
[1;32m    372[0m                 service_id[38;5;241m=[39m[38;5;28mself[39m[38;5;241m.[39m_service_model[38;5;241m.[39mservice_id[38;5;241m.[39mhyphenize(),
[0;32m   (...)[0m
[1;32m    376[0m             context[38;5;241m=[39mrequest_context,
[1;32m    377[0m         )

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/aiobotocore/endpoint.py:96[0m, in [0;36mAioEndpoint._send_request[0;34m(self, request_dict, operation_model)[0m
[1;32m     94[0m context [38;5;241m=[39m request_dict[[38;5;124m'[39m[38;5;124mcontext[39m[38;5;124m'[39m]
[1;32m     95[0m [38;5;28mself[39m[38;5;241m.[39m_update_retries_context(context, attempts)
[0;32m---> 96[0m request [38;5;241m=[39m [38;5;28;01mawait[39;00m [38;5;28mself[39m[38;5;241m.[39mcreate_request(request_dict, operation_model)
[1;32m     97[0m success_response, exception [38;5;241m=[39m [38;5;28;01mawait[39;00m [38;5;28mself[39m[38;5;241m.[39m_get_response(
[1;32m     98[0m     request, operation_model, context
[1;32m     99[0m )
[1;32m    100[0m [38;5;28;01mwhile[39;00m [38;5;28;01mawait[39;00m [38;5;28mself[39m[38;5;241m.[39m_needs_retry(
[1;32m    101[0m     attempts,
[1;32m    102[0m     operation_model,
[0;32m   (...)[0m
[1;32m    105[0m     exception,
[1;32m    106[0m ):

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/aiobotocore/endpoint.py:84[0m, in [0;36mAioEndpoint.create_request[0;34m(self, params, operation_model)[0m
[1;32m     80[0m     service_id [38;5;241m=[39m operation_model[38;5;241m.[39mservice_model[38;5;241m.[39mservice_id[38;5;241m.[39mhyphenize()
[1;32m     81[0m     event_name [38;5;241m=[39m [38;5;124m'[39m[38;5;124mrequest-created.[39m[38;5;132;01m{service_id}[39;00m[38;5;124m.[39m[38;5;132;01m{op_name}[39;00m[38;5;124m'[39m[38;5;241m.[39mformat(
[1;32m     82[0m         service_id[38;5;241m=[39mservice_id, op_name[38;5;241m=[39moperation_model[38;5;241m.[39mname
[1;32m     83[0m     )
[0;32m---> 84[0m     [38;5;28;01mawait[39;00m [38;5;28mself[39m[38;5;241m.[39m_event_emitter[38;5;241m.[39memit(
[1;32m     85[0m         event_name,
[1;32m     86[0m         request[38;5;241m=[39mrequest,
[1;32m     87[0m         operation_name[38;5;241m=[39moperation_model[38;5;241m.[39mname,
[1;32m     88[0m     )
[1;32m     89[0m prepared_request [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39mprepare_request(request)
[1;32m     90[0m [38;5;28;01mreturn[39;00m prepared_request

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/aiobotocore/hooks.py:66[0m, in [0;36mAioHierarchicalEmitter._emit[0;34m(self, event_name, kwargs, stop_on_response)[0m
[1;32m     63[0m logger[38;5;241m.[39mdebug([38;5;124m'[39m[38;5;124mEvent [39m[38;5;132;01m%s[39;00m[38;5;124m: calling handler [39m[38;5;132;01m%s[39;00m[38;5;124m'[39m, event_name, handler)
[1;32m     65[0m [38;5;66;03m# Await the handler if its a coroutine.[39;00m
[0;32m---> 66[0m response [38;5;241m=[39m [38;5;28;01mawait[39;00m resolve_awaitable(handler([38;5;241m*[39m[38;5;241m*[39mkwargs))
[1;32m     67[0m responses[38;5;241m.[39mappend((handler, response))
[1;32m     68[0m [38;5;28;01mif[39;00m stop_on_response [38;5;129;01mand[39;00m response [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/aiobotocore/_helpers.py:15[0m, in [0;36mresolve_awaitable[0;34m(obj)[0m
[1;32m     13[0m [38;5;28;01masync[39;00m [38;5;28;01mdef[39;00m [38;5;21mresolve_awaitable[39m(obj):
[1;32m     14[0m     [38;5;28;01mif[39;00m inspect[38;5;241m.[39misawaitable(obj):
[0;32m---> 15[0m         [38;5;28;01mreturn[39;00m [38;5;28;01mawait[39;00m obj
[1;32m     17[0m     [38;5;28;01mreturn[39;00m obj

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/aiobotocore/signers.py:23[0m, in [0;36mAioRequestSigner.handler[0;34m(self, operation_name, request, **kwargs)[0m
[1;32m     18[0m [38;5;28;01masync[39;00m [38;5;28;01mdef[39;00m [38;5;21mhandler[39m([38;5;28mself[39m, operation_name[38;5;241m=[39m[38;5;28;01mNone[39;00m, request[38;5;241m=[39m[38;5;28;01mNone[39;00m, [38;5;241m*[39m[38;5;241m*[39mkwargs):
[1;32m     19[0m     [38;5;66;03m# This is typically hooked up to the "request-created" event[39;00m
[1;32m     20[0m     [38;5;66;03m# from a client's event emitter.  When a new request is created[39;00m
[1;32m     21[0m     [38;5;66;03m# this method is invoked to sign the request.[39;00m
[1;32m     22[0m     [38;5;66;03m# Don't call this method directly.[39;00m
[0;32m---> 23[0m     [38;5;28;01mreturn[39;00m [38;5;28;01mawait[39;00m [38;5;28mself[39m[38;5;241m.[39msign(operation_name, request)

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/aiobotocore/signers.py:81[0m, in [0;36mAioRequestSigner.sign[0;34m(self, operation_name, request, region_name, signing_type, expires_in, signing_name)[0m
[1;32m     78[0m     [38;5;28;01melse[39;00m:
[1;32m     79[0m         [38;5;28;01mraise[39;00m e
[0;32m---> 81[0m [43mauth[49m[38;5;241;43m.[39;49m[43madd_auth[49m[43m([49m[43mrequest[49m[43m)[49m

File [0;32m~/micromamba-root/envs/clivar/lib/python3.10/site-packages/botocore/auth.py:407[0m, in [0;36mSigV4Auth.add_auth[0;34m(self, request)[0m
[1;32m    405[0m [38;5;28;01mdef[39;00m [38;5;21madd_auth[39m([38;5;28mself[39m, request):
[1;32m    406[0m     [38;5;28;01mif[39;00m [38;5;28mself[39m[38;5;241m.[39mcredentials [38;5;129;01mis[39;00m [38;5;28;01mNone[39;00m:
[0;32m--> 407[0m         [38;5;28;01mraise[39;00m NoCredentialsError()
[1;32m    408[0m     datetime_now [38;5;241m=[39m datetime[38;5;241m.[39mdatetime[38;5;241m.[39mutcnow()
[1;32m    409[0m     request[38;5;241m.[39mcontext[[38;5;124m'[39m[38;5;124mtimestamp[39m[38;5;124m'[39m] [38;5;241m=[39m datetime_now[38;5;241m.[39mstrftime(SIGV4_TIMESTAMP)

[0;31mNoCredentialsError[0m: Unable to locate credentials
NoCredentialsError: Unable to locate credentials

